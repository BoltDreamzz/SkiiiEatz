{%extends 'partials/base2.html'%}
{%block title%}All Restaurants{%endblock%}
{%load static%}
{% load rating_tags %}

{%block content%}


<script>
    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    primary: '#FCA311',
                    secondary: '#F7931E',
                }
            }
        }
    }
</script>

<!-- <div class="flex items-center justify-between bg-white z-10 top-10 left-0 right-0 px-4 py-3 shadow-md"> -->

<!-- </div> -->
<div class="flex sticky top-20 z-50 gap-3 items-center mx-3 my-4">
    <button onclick="history.back()"
        class="p-2 flex items-center justify-center min-w-12 h-12 bg-white shadow-md rounded-2xl"><svg
            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5">
            <path fill-rule="evenodd"
                d="M11.78 5.22a.75.75 0 0 1 0 1.06L8.06 10l3.72 3.72a.75.75 0 1 1-1.06 1.06l-4.25-4.25a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0Z"
                clip-rule="evenodd" />
        </svg>

    </button>
    Go Back
    <!-- <a href="#" class="">Eatz</a> -->
</div>

<div class="lg:hidden flex items-center justify-center mx-auto">
    <img src="{%static 'images/res_ad.png'%}" class="object-cover max-w-90 h-auto" alt="" data-aos="flip-right"
        data-aos-delay="500">
</div>

<div class="p-3">

    <!-- Categories Section -->
    <!-- <section class="bg-white py-4 rounded-2xl mb-2">

        <div class="max-w-7xl mx-3 px-4">
            <h2 class="text-lg font-semibold mb-4">Explore</h2>
            <div class="flex space-x-3 overflow-x-auto scrollbar-hide pb-2" id="categories">
                <a href="#" class="flex-shrink-0 text-center cursor-pointer">
                    <div
                        class="w-24 h-24 bg-red-100 rounded-2xl flex items-center justify-center mb-2 hover:bg-red-200 transition-colors">
                        <img src="{%static 'images/res.png'%}" alt="" class="w-20 h-20">
                    </div>
                    <span class="text-sm text-primary font-bold">Restaurants</span>
                </a>
                <a href="#" class="flex-shrink-0 text-center cursor-pointer" hx-trigger="click">
                    <div
                        class="w-24 h-24 bg-blue-100 rounded-2xl flex items-center justify-center mb-2 hover:bg-blue-200 transition-colors">
                        <img src="{%static 'images/sup.png'%}" alt="" class="w-20 h-20">
                    </div>
                    <span class="text-xs text-gray-700">Supermarkets</span>
                </a>
                <a href="#" class="flex-shrink-0 text-center cursor-pointer" hx-trigger="click">
                    <div
                        class="w-24 h-24 bg-yellow-100 rounded-2xl flex items-center justify-center mb-2 hover:bg-yellow-200 transition-colors">
                        <img src="{%static 'images/med.png'%}" alt="" class="w-20 h-20">
                    </div>
                    <span class="text-xs text-gray-700">Pharmacies</span>
                </a>
                <a href="#" class="flex-shrink-0 text-center cursor-pointer" hx-trigger="click">
                    <div
                        class="w-24 h-24 bg-green-100 rounded-2xl flex items-center justify-center mb-2 hover:bg-green-200 transition-colors">
                        <img src="{%static 'images/apt.png'%}" alt="" class="w-20 h-20">
                    </div>
                    <span class="text-xs text-gray-700">Apartments</span>
                </a>

            </div>
        </div>
    </section> -->
    <div class="md:hidden flex flex-col bg-white mb-2 px-4 py-3 rounded-2xl">
        <div class="relative">
            <input type="text" placeholder="Search restaurants, cuisines..."
                class="w-full pl-10 pr-4 py-2 border border-gray-300 mb-2 rounded-2xl focus:outline-none focus:ring-2 focus:ring-primary">
            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5 -mb-2">
                    <path fill-rule="evenodd"
                        d="M9 3.5a5.5 5.5 0 1 0 0 11 5.5 5.5 0 0 0 0-11ZM2 9a7 7 0 1 1 12.452 4.391l3.328 3.329a.75.75 0 1 1-1.06 1.06l-3.329-3.328A7 7 0 0 1 2 9Z"
                        clip-rule="evenodd" />
                </svg>

            </i>
        </div>
        <div class="relative flex mt-2 flex-col text-xs">
            <span class="font-semibold">Popular Searches:</span>
            <div class="flex items-center gap-2 p-2">
                <a href="#" class="text-decoration bg-[#FFF1D9] border border-primary py-1 px-2 rounded-lg">Papa
                    YumYum</a>
                <a href="#" class="text-decoration bg-[#FFF1D9] border border-primary py-1 px-2 rounded-lg">Pizza</a>
                <a href="#" class="text-decoration bg-[#FFF1D9] border border-primary py-1 px-2 rounded-lg">Burger</a>

            </div>
        </div>
    </div>




    <section class="py-6 bg-white rounded-2xl mb-3">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-semibold">Sponsored</h2>
                <button class="text-primary text-sm font-medium">See All</button>
            </div>
            <div class="flex space-x-4 overflow-x-auto scrollbar-hide pb-2">
                {% for restaurant in sponsored_restaurants%}
                <a href="{%url 'core:restaurant_detail' restaurant.slug %}" class="text-decoration-none">
                    <div class="flex-shrink-0 w-64 p-2 rounded-2xl hover:shadow-md transition-shadow cursor-pointer">
                        <div class="relative">
                            <img src="{{restaurant.image.url}}?height=120&width=256" alt="{{restaurant.name}}"
                                class="w-full h-32 object-cover rounded-2xl shadow-sm">
                            <div
                                class="absolute shadow top-2 left-2 bg-[#FFF1D9] text-white text-xs px-2 py-1 rounded-md">
                                <img src="{%static 'images/prom.png'%}" alt="" class="w-4 h-4">
                            </div>
                            <div class="absolute top-2 right-2 bg-white rounded-full p-1">
                                <i class="fas fa-heart text-gray-400 text-sm"></i>
                            </div>
                        </div>
                        <div class="p-3">
                            <h3 class="font-semibold text-gray-800">{{restaurant.name}}</h3>
                            <div class="flex justify-between items-center mt-1">
                                <div class="flex text-yellow-400 text-xs">
                                    {{ restaurant.rating|inline_star_rating|safe }}
                                </div>
                                <span class="text-xs text-gray-600 ml-1">
                                    {{ restaurant.rating }}
                                    ({{restaurant.review_count|default:'10+'}})</span>
                            </div>
                            <div class="flex items-center justify-between mt-2">
                                <span class="text-xs text-gray-600">{{restaurant.preparation_time}} min â€¢ â‚¦1,999
                                    delivery</span>
                                <span class="text-xs bg-[#FFF1D9] border border-primary py-1 px-2 rounded-lg">
                                    {{restaurant.tag|default:"10% off"|truncatewords:3}}</span>
                            </div>
                        </div>
                    </div>
                </a>


                {% endfor %}


            </div>
        </div>
    </section>

    <!-- Filters -->
    <section class="py-4 bg-gray-50 rounded-2xl">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex items-center space-x-4 overflow-x-auto scrollbar-hide">
                <button
                    class="flex-shrink-0 flex items-center space-x-2 bg-white px-4 py-2 rounded-full border hover:border-primary transition-colors">
                    <i class="fas fa-sliders-h text-gray-600"></i>
                    <span class="text-sm">Filters</span>
                </button>
                <button class="flex-shrink-0 bg-primary text-white px-4 py-2 rounded-full text-sm">
                    Delivery
                </button>
                <button
                    class="flex-shrink-0 bg-white px-4 py-2 rounded-full text-sm border hover:border-primary transition-colors">
                    Pickup
                </button>
                <button
                    class="flex-shrink-0 bg-white px-4 py-2 rounded-full text-sm border hover:border-primary transition-colors">
                    Under 30 min
                </button>
                <button
                    class="flex-shrink-0 bg-white px-4 py-2 rounded-full text-sm border hover:border-primary transition-colors">
                    Free delivery
                </button>
                <button
                    class="flex-shrink-0 bg-white px-4 py-2 rounded-full text-sm border hover:border-primary transition-colors">
                    $$ - $$$
                </button>
            </div>
        </div>
    </section>

    <!-- All Restaurants Grid -->
    <section class="py-6" id="restaurants">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-semibold">All Restaurants</h2>
                <div class="flex items-center space-x-2">
                    <span class="text-sm text-gray-600">Sort by:</span>
                    <select class="text-sm border-none bg-transparent focus:outline-none cursor-pointer">
                        <option>Recommended</option>
                        <option>Rating</option>
                        <option>Delivery time</option>
                        <option>Distance</option>
                    </select>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- Restaurant Card 1 -->
                {% for restaurant in restaurants%}
                <a href="{%url 'core:restaurant_detail' restaurant.slug%}" class="text-decoration-none">
                    <div class="hover:shadow-md p-2 rounded-2xl transition-shadow cursor-pointer">
                        <div class="relative">
                            <img src="{{restaurant.image.url}}?height=160&width=300" alt="{{restaurant.name}}"
                                class="w-full h-40 object-cover rounded-2xl">
                            <div class="absolute top-2 right-2 bg-white rounded-full p-1">
                                <i class="fas fa-heart text-gray-400 text-sm"></i>
                            </div>
                            <div
                                class="absolute bottom-2 left-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded">
                                {{restaurant.preparation_time}} min
                            </div>
                        </div>
                        <div class="p-3">
                                <h3 class="font-semibold text-gray-800">{{restaurant.name}}</h3>
                                <div class="flex justify-between items-center mt-1">
                                    <div class="flex text-yellow-400 text-xs">
                                        {{ restaurant.rating|inline_star_rating|safe }}
                                    </div>
                                    <span class="text-xs text-gray-600 ml-1">
                                        {{ restaurant.rating }}
                                        ({{restaurant.review_count|default:'10+'}})</span>
                                </div>
                                <div class="flex items-center justify-between mt-2">
                                    <span class="text-green-500 text-sm">
                                    {{restaurant.tags|default:'Lagos, Tasty'}}
                                </span>
                                    <span class="text-xs bg-[#FFF1D9] border border-primary py-1 px-2 rounded-lg">
                                        {{restaurant.tag|default:"10% off"|truncatewords:3}}</span>
                                </div>
                            </div>
                        
                    </div>
                </a>

                {% endfor %}

            </div>

            <!-- Load More Button -->
            <div class="text-center mt-8">
                <button class="bg-primary text-white px-8 py-3 rounded-2xl hover:bg-opacity-90 transition-colors">
                    Load More Restaurants
                </button>
            </div>
        </div>
    </section>



    <!-- Custom Styles -->
    <style>
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }

        /* Auto-rotate ads */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(100%);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .ad-slide {
            animation: slideIn 0.5s ease-in-out;
        }
    </style>

    <!-- HTMX Auto-rotate ads script -->
    <!-- <script>
        // Auto-rotate ads every 5 seconds
        setInterval(() => {
            htmx.ajax('GET', '/ad/next', { target: '#ad-banner' });
        }, 5000);
    </script> -->
</div>

<main class="max-w-6xl mx-auto py-8 px-4">
    {% if city %}
    <!-- Restaurants -->
    <section class="mb-10">
        <h2 class="text-2xl font-semibold mb-4">ğŸ½ï¸ Restaurants in {{ city.name }}</h2>
        {% if restaurants %}
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for restaurant in restaurants %}
            <div class="bg-white border rounded-lg shadow p-4">
                <h3 class="text-lg font-bold">{{ restaurant.name }}</h3>
                <p class="text-sm text-gray-600">{{ restaurant.description|default:"No description" }}</p>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p class="text-gray-500">No restaurants found in this city.</p>
        {% endif %}
    </section>

    <!-- Supermarkets -->
    <section>
        <h2 class="text-2xl font-semibold mb-4">ğŸ›’ Supermarkets in {{ city.name }}</h2>
        {% if supermarkets %}
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for market in supermarkets %}
            <div class="bg-white border rounded-lg shadow p-4">
                <h3 class="text-lg font-bold">{{ market.name }}</h3>
                <p class="text-sm text-gray-600">{{ market.description|default:"No description" }}</p>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p class="text-gray-500">No supermarkets found in this city.</p>
        {% endif %}
    </section>
    {% else %}
    <div class="text-center py-20">
        <p class="text-xl text-gray-600">No city selected. Please go back and choose a valid city.</p>
        <a href="{% url 'core:homepage' %}"
            class="mt-4 inline-block bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition">Go to
            Homepage</a>
    </div>
    {% endif %}
</main>

{%endblock%}